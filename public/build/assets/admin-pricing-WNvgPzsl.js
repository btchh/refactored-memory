document.addEventListener("DOMContentLoaded",()=>{const e=document.querySelectorAll(".pricing-tab"),n=document.querySelectorAll(".pricing-panel");e.forEach(t=>{t.addEventListener("click",()=>{const o=t.dataset.tab;e.forEach(s=>s.classList.remove("active")),t.classList.add("active"),n.forEach(s=>{s.id===`${o}-panel`?s.classList.remove("hidden"):s.classList.add("hidden")})})}),l(),a()});function l(){const e=document.getElementById("service-form");e&&e.addEventListener("submit",async n=>{n.preventDefault();const t=document.getElementById("service-id").value,o={service_name:document.getElementById("service-name").value,item_type:document.getElementById("service-item-type").value,price:document.getElementById("service-price").value,description:document.getElementById("service-description").value},s=t?window.pricingRoutes.services.update.replace("__ID__",t):window.pricingRoutes.services.store,c=t?"PUT":"POST";try{const d=await(await fetch(s,{method:c,headers:{"Content-Type":"application/json","X-CSRF-TOKEN":window.pricingRoutes.csrf},body:JSON.stringify(o)})).json();d.success?(r("success",d.message),document.getElementById("service-modal").close(),setTimeout(()=>window.location.reload(),1e3)):r("error",d.message)}catch(i){console.error("Error:",i),r("error","Failed to save service")}})}window.openServiceModal=(e=null)=>{const n=document.getElementById("service-modal"),t=document.getElementById("service-modal-title"),o=document.getElementById("service-form");e?(t.textContent="Edit Service",document.getElementById("service-id").value=e.id,document.getElementById("service-name").value=e.service_name,document.getElementById("service-item-type").value=e.item_type,document.getElementById("service-price").value=e.price,document.getElementById("service-description").value=e.description||""):(t.textContent="Add Service",o.reset(),document.getElementById("service-id").value=""),n.showModal()};window.editService=e=>{window.openServiceModal(e)};window.deleteService=async(e,n)=>{if(confirm(`Delete "${n}"?`))try{const o=await(await fetch(window.pricingRoutes.services.delete.replace("__ID__",e),{method:"DELETE",headers:{"X-CSRF-TOKEN":window.pricingRoutes.csrf,"Content-Type":"application/json"}})).json();o.success?(r("success",o.message),setTimeout(()=>window.location.reload(),1e3)):r("error",o.message)}catch(t){console.error("Error:",t),r("error","Failed to delete service")}};function a(){const e=document.getElementById("product-form");e&&e.addEventListener("submit",async n=>{n.preventDefault();const t=document.getElementById("product-id").value,o={product_name:document.getElementById("product-name").value,item_type:document.getElementById("product-item-type").value,price:document.getElementById("product-price").value,description:document.getElementById("product-description").value},s=t?window.pricingRoutes.products.update.replace("__ID__",t):window.pricingRoutes.products.store,c=t?"PUT":"POST";try{const d=await(await fetch(s,{method:c,headers:{"Content-Type":"application/json","X-CSRF-TOKEN":window.pricingRoutes.csrf},body:JSON.stringify(o)})).json();d.success?(r("success",d.message),document.getElementById("product-modal").close(),setTimeout(()=>window.location.reload(),1e3)):r("error",d.message)}catch(i){console.error("Error:",i),r("error","Failed to save product")}})}window.openProductModal=(e=null)=>{const n=document.getElementById("product-modal"),t=document.getElementById("product-modal-title"),o=document.getElementById("product-form");e?(t.textContent="Edit Product",document.getElementById("product-id").value=e.id,document.getElementById("product-name").value=e.product_name,document.getElementById("product-item-type").value=e.item_type,document.getElementById("product-price").value=e.price,document.getElementById("product-description").value=e.description||""):(t.textContent="Add Product",o.reset(),document.getElementById("product-id").value=""),n.showModal()};window.editProduct=e=>{window.openProductModal(e)};window.deleteProduct=async(e,n)=>{if(confirm(`Delete "${n}"?`))try{const o=await(await fetch(window.pricingRoutes.products.delete.replace("__ID__",e),{method:"DELETE",headers:{"X-CSRF-TOKEN":window.pricingRoutes.csrf,"Content-Type":"application/json"}})).json();o.success?(r("success",o.message),setTimeout(()=>window.location.reload(),1e3)):r("error",o.message)}catch(t){console.error("Error:",t),r("error","Failed to delete product")}};function r(e,n){const t=document.getElementById("alert-container");if(!t)return;const o=e==="success"?"alert-success":"alert-error",s=e==="success"?"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z":"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z",c=document.createElement("div");c.className=`alert ${o} mb-4`,c.innerHTML=`
        <svg class="w-5 h-5 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="${s}" />
        </svg>
        <span>${n}</span>
        <button onclick="this.parentElement.remove()" class="ml-auto">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
            </svg>
        </button>
    `,t.appendChild(c),setTimeout(()=>{c.style.opacity="0",setTimeout(()=>c.remove(),300)},5e3)}
