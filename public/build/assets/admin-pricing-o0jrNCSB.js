document.addEventListener("DOMContentLoaded",()=>{const e=document.querySelectorAll(".pricing-tab"),o=document.querySelectorAll(".pricing-panel");e.forEach(t=>{t.addEventListener("click",()=>{const n=t.dataset.tab;e.forEach(c=>{c.classList.remove("active","border-blue-600","text-blue-600","bg-white","-mb-px"),c.classList.add("border-transparent","text-gray-500")}),t.classList.add("active","border-blue-600","text-blue-600","bg-white","-mb-px"),t.classList.remove("border-transparent","text-gray-500"),o.forEach(c=>{c.id===`${n}-panel`?c.classList.remove("hidden"):c.classList.add("hidden")})})}),l(),u()});function l(){const e=document.getElementById("service-form");e&&e.addEventListener("submit",async o=>{o.preventDefault();const t=document.getElementById("service-id").value,n=document.querySelector('input[name="service_item_type"]:checked')?.value;if(!n){r("error","Please select an item type");return}const c={service_name:document.getElementById("service-name").value,item_type:n,price:document.getElementById("service-price").value,description:document.getElementById("service-description").value},i=t?window.pricingRoutes.services.update.replace("__ID__",t):window.pricingRoutes.services.store,a=t?"PUT":"POST";try{const d=await(await fetch(i,{method:a,headers:{"Content-Type":"application/json","X-CSRF-TOKEN":window.pricingRoutes.csrf},body:JSON.stringify(c)})).json();d.success?(r("success",d.message),closeServiceModal(),setTimeout(()=>window.location.reload(),1e3)):r("error",d.message)}catch(s){console.error("Error:",s),r("error","Failed to save service")}})}window.openServiceModal=()=>{const e=document.getElementById("service-modal");document.getElementById("service-modal-title").textContent="Add Service",document.getElementById("service-form").reset(),document.getElementById("service-id").value="",e.classList.remove("hidden")};window.closeServiceModal=()=>{document.getElementById("service-modal").classList.add("hidden")};window.editService=e=>{const o=document.getElementById("service-modal");document.getElementById("service-modal-title").textContent="Edit Service",document.getElementById("service-id").value=e.id,document.getElementById("service-name").value=e.service_name,document.getElementById("service-price").value=e.price,document.getElementById("service-description").value=e.description||"";const t=document.querySelector(`input[name="service_item_type"][value="${e.item_type}"]`);t&&(t.checked=!0),o.classList.remove("hidden")};window.deleteService=async(e,o)=>{if(confirm(`Delete "${o}"? This action cannot be undone.`))try{const n=await(await fetch(window.pricingRoutes.services.delete.replace("__ID__",e),{method:"DELETE",headers:{"X-CSRF-TOKEN":window.pricingRoutes.csrf,"Content-Type":"application/json"}})).json();n.success?(r("success",n.message),setTimeout(()=>window.location.reload(),1e3)):r("error",n.message)}catch(t){console.error("Error:",t),r("error","Failed to delete service")}};function u(){const e=document.getElementById("product-form");e&&e.addEventListener("submit",async o=>{o.preventDefault();const t=document.getElementById("product-id").value,n=document.querySelector('input[name="product_item_type"]:checked')?.value;if(!n){r("error","Please select an item type");return}const c={product_name:document.getElementById("product-name").value,item_type:n,price:document.getElementById("product-price").value,description:document.getElementById("product-description").value},i=t?window.pricingRoutes.products.update.replace("__ID__",t):window.pricingRoutes.products.store,a=t?"PUT":"POST";try{const d=await(await fetch(i,{method:a,headers:{"Content-Type":"application/json","X-CSRF-TOKEN":window.pricingRoutes.csrf},body:JSON.stringify(c)})).json();d.success?(r("success",d.message),closeProductModal(),setTimeout(()=>window.location.reload(),1e3)):r("error",d.message)}catch(s){console.error("Error:",s),r("error","Failed to save product")}})}window.openProductModal=()=>{const e=document.getElementById("product-modal");document.getElementById("product-modal-title").textContent="Add Product",document.getElementById("product-form").reset(),document.getElementById("product-id").value="",e.classList.remove("hidden")};window.closeProductModal=()=>{document.getElementById("product-modal").classList.add("hidden")};window.editProduct=e=>{const o=document.getElementById("product-modal");document.getElementById("product-modal-title").textContent="Edit Product",document.getElementById("product-id").value=e.id,document.getElementById("product-name").value=e.product_name,document.getElementById("product-price").value=e.price,document.getElementById("product-description").value=e.description||"";const t=document.querySelector(`input[name="product_item_type"][value="${e.item_type}"]`);t&&(t.checked=!0),o.classList.remove("hidden")};window.deleteProduct=async(e,o)=>{if(confirm(`Delete "${o}"? This action cannot be undone.`))try{const n=await(await fetch(window.pricingRoutes.products.delete.replace("__ID__",e),{method:"DELETE",headers:{"X-CSRF-TOKEN":window.pricingRoutes.csrf,"Content-Type":"application/json"}})).json();n.success?(r("success",n.message),setTimeout(()=>window.location.reload(),1e3)):r("error",n.message)}catch(t){console.error("Error:",t),r("error","Failed to delete product")}};function r(e,o){window.Toast&&window.Toast.show(o,e)}
